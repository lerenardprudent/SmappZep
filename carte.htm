<!DOCTYPE html>
<html>
  <head>
    <title>SMAPP - Visualisations des lieux de domiciles des participants sélectionnés</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="http://code.jquery.com/jquery-1.8.0.min.js"></script>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.css" />
    <style>
      body { padding: 0; margin: 0; }
      html, body, #map { height: 100%; width: 100%; }
    </style>
    <script src="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.js"></script>
  </head>
  <body>
    <div id="map"></div>
    <script>
            // create a map in the "map" div, set the view to a given place and zoom
        var map = L.map('map').setView([45.51947, -73.56017],13);
        var latMin = null, latMax = null, lngMin = null, lngMax = null;
        // add an OpenStreetMap tile layer
        L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        function addPopup(feature, layer) {
            // does this feature have a property named popupContent?
            if (feature.properties && feature.properties.name) {
                layer.bindPopup(feature.properties.name);
            }
            var coords = feature.geometry.coordinates;
            var lat = coords[1];
            var lng = coords[0];
            if ( latMin == null || lat < latMin ) {
              latMin = lat;
            }
            if ( latMax == null || lat > latMax ) {
              latMax = lat;
            }
            if ( lngMin == null || lng < lngMin ) {
              lngMin = lng;
            }
            if ( lngMax == null || lng > lngMax ) {
              lngMax = lng;
            }
        }

        $.getJSON("addr_participants.geojson", function(json) {
          L.geoJson(json, {onEachFeature: addPopup}).addTo(map);
        });

        $(document).ready( function() {
          var southWest = L.latLng(latMin, lngMin),
            northEast = L.latLng(latMax, lngMax),
            bounds = L.latLngBounds(southWest, northEast);
          map.fitBounds(bounds);
      });
    </script>
  </body>
</html>

